image: php:latest

stages:
  - build
  - test

cache:
  paths:
  - vendor/

before_script:
  - apt-get update
  - apt-get install --assume-yes git zip unzip

composer:
  stage: build
  script:
    - apt-get update
    - apt-get install --assume-yes git zip unzip
    - export APP_ENV=testing
    - php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
    - php composer-setup.php
    - php -r "unlink('composer-setup.php');"
    - php composer.phar install

phpMess:
  stage: test
  script:
    - php vendor/bin/phpmd src/ text cleancode,controversial,codesize,design,naming,unusedcode